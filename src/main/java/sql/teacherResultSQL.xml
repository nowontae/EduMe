<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="teacherResult">
	<select id="teacherAllResult" resultType="Integer" parameterType="map">
		select sum(camount) from credit where midx=#{midx}
	</select>

	<select id="teacherResult6M_1" resultType="Integer" parameterType="map" >
		select sum(camount) 
		from credit 
		where midx=#{midx} and (
		select to_char(add_months(sysdate,-1),'yyyymmdd') 
		from dual) <![CDATA[<]]> to_char(cpaydate,'yyyymmdd')
	</select>
	<select id="teacherResult6M_2" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-2),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-1),'yyyymmdd') 
		from dual)
	</select>
	<select id="teacherResult6M_3" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-3),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-2),'yyyymmdd') 
		from dual)
	</select>
	<select id="teacherResult6M_4" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-4),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-3),'yyyymmdd') 
		from dual)
	</select>
	<select id="teacherResult6M_5" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit
		 where midx=#{midx} 
		 and to_char(cpaydate, 'yyyymmdd') between (
		 select to_char(add_months(sysdate,-5),'yyyymmdd') 
		 from dual) 
		 and (select to_char(add_months(sysdate,-4),'yyyymmdd') 
		 from dual)	
	</select>
	<select id="teacherResult6M_6" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-6),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-5),'yyyymmdd') 
		from dual)
	</select>


	<select id="teacherResult12M_2" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} and (
		select to_char(add_months(sysdate,-2),'yyyymmdd') 
		from dual) <![CDATA[<]]> to_char(cpaydate,'yyyymmdd')
	</select>	
	<select id="teacherResult12M_4" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-4),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-2),'yyyymmdd') 
		from dual)	
	</select>
	<select id="teacherResult12M_6" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-6),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-4),'yyyymmdd') 
		from dual)	
	</select>
	<select id="teacherResult12M_8" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-8),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-6),'yyyymmdd') 
		from dual)	
	</select>	
	<select id="teacherResult12M_10" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-10),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-8),'yyyymmdd') 
		from dual)	
	</select>	
	<select id="teacherResult12M_12" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(add_months(sysdate,-12),'yyyymmdd') 
		from dual) 
		and (select to_char(add_months(sysdate,-10),'yyyymmdd') 
		from dual)	
	</select>
	
	
	<select id="teacherResult28D_7" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and (select to_char(sysdate-7,'yyyymmdd') 
		from dual) <![CDATA[<]]> to_char(cpaydate,'yyyymmdd')
	</select>
	<select id="teacherResult28D_14" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(sysdate-14,'yyyymmdd') from dual) 
		and (
		select to_char(sysdate-7,'yyyymmdd') from dual)
	</select>
	<select id="teacherResult28D_21" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(sysdate-21,'yyyymmdd') from dual) 
		and (
		select to_char(sysdate-14,'yyyymmdd') from dual)
	</select>	
	<select id="teacherResult28D_28" resultType="Integer" parameterType="map">
		select sum(camount) 
		from credit 
		where midx=#{midx} 
		and to_char(cpaydate, 'yyyymmdd') between (
		select to_char(sysdate-28,'yyyymmdd') from dual) 
		and (
		select to_char(sysdate-21,'yyyymmdd') from dual)
	</select>	
	

	
	
<!-- teacherGrade 부분 -->
	<select id="teacherGradeAvg" resultType="Integer" parameterType="map">
		select avg(rscore) 
		from (select lidx from lecture where midx=#{midx}) a, review b
		where a.lidx=b.lidx
	</select>
	
	<select id="teacherGradeCount1M" resultType="Integer" parameterType="map">
	select count(rscore) 
	from (select lidx from lecture where midx=#{midx}) a, review b
	where a.lidx=b.lidx
	and (select to_char(add_months(sysdate,-2), 'yyyymmdd') 
	from dual) <![CDATA[<]]> to_char(rwritedate,'yyyymmdd')
	</select>
	
	
	
	
	
	
	
	
	
</mapper>