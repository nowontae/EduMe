<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="teacherBoardReview">

<!-- 강의명, 등록날짜, 평균별점 불러오기-->
 <select id="teacherReviewMain" resultType="com.edume.teacherBoardReview.model.TeacherBoardReviewDTO">
 select avg.*, l.ltitle, l.lwritedate
 from  
		(select l.lidx,  avg(rscore) as avggrade
			from (select lidx
       				from lecture
        			where midx=#{midx}) l,review r
 			where l.lidx=r.lidx
 			group by l.lidx ) avg, lecture l
 where avg.lidx = l.lidx
  </select>


<!-- 강의별 후기보기 -->
  <select id="teacherReviewContent" resultType="com.edume.teacherBoardReview.model.TeacherBoardReviewDTO">
select m.mid, r.*
from	(select rcomment,rscore,rwritedate, midx
        from review
        where lidx=#{lidx}) r, member m
where r.midx=m.midx
  </select>
  
</mapper>